INFO:root:Namespace(model_name='NeuMF')
INFO:root:--------------------------------------------- BEGIN: 2022-07-25 21:52:55 ---------------------------------------------
INFO:root:
==============================
 Arguments       | Values     
==============================
 batch_size      | 500000    
 dataset         | coclick_1d
 dropout         | 0.2       
 early_stop      | 10        
 emb_size        | 128       
 epoch           | 200       
 eval_batch_size | 256       
 gpu             | 0         
 l2              | 1e-07     
 layers          | [64]      
 lr              | 0.0005    
 num_neg         | 1         
 num_workers     | 8         
 optimizer       | Adam      
 random_seed     | 0         
 test_all        | 0         
 topk            | 5,10,20,50
==============================
INFO:root:Device: cuda
INFO:root:Load corpus from ../data/coclick_1d/BaseReader.pkl
INFO:root:#params: 1349460224
INFO:root:NeuMF(
  (mf_u_embeddings): Embedding(2635632, 128)
  (mf_i_embeddings): Embedding(2635632, 128)
  (mlp_u_embeddings): Embedding(2635632, 128)
  (mlp_i_embeddings): Embedding(2635632, 128)
  (mlp): ModuleList(
    (0): Linear(in_features=256, out_features=64, bias=True)
  )
  (dropout_layer): Dropout(p=0.2, inplace=False)
  (prediction): Linear(in_features=192, out_features=1, bias=False)
)
INFO:root:Optimizer: Adam
INFO:root:Epoch 1     loss=0.6921 [31.0 s]    dev=(HR@5:0.8326,NDCG@5:0.7099) [1.2 s] *
INFO:root:Epoch 2     loss=0.6699 [30.2 s]    dev=(HR@5:0.8768,NDCG@5:0.7509) [1.2 s] *
INFO:root:Epoch 3     loss=0.5633 [30.7 s]    dev=(HR@5:0.8861,NDCG@5:0.7570) [1.2 s] *
INFO:root:Epoch 4     loss=0.4174 [31.8 s]    dev=(HR@5:0.8907,NDCG@5:0.7600) [1.2 s] *
INFO:root:Epoch 5     loss=0.3580 [30.5 s]    dev=(HR@5:0.8950,NDCG@5:0.7625) [1.3 s] *
INFO:root:Epoch 6     loss=0.3418 [29.2 s]    dev=(HR@5:0.8962,NDCG@5:0.7620) [1.2 s]
INFO:root:Epoch 7     loss=0.3335 [30.8 s]    dev=(HR@5:0.8970,NDCG@5:0.7625) [1.3 s] *
INFO:root:Epoch 8     loss=0.3259 [30.4 s]    dev=(HR@5:0.8975,NDCG@5:0.7629) [1.0 s] *
INFO:root:Epoch 9     loss=0.3197 [29.3 s]    dev=(HR@5:0.8999,NDCG@5:0.7641) [1.1 s] *
INFO:root:Epoch 10    loss=0.3137 [28.1 s]    dev=(HR@5:0.9012,NDCG@5:0.7654) [1.1 s] *
INFO:root:Epoch 11    loss=0.3082 [28.0 s]    dev=(HR@5:0.9024,NDCG@5:0.7661) [1.0 s] *
INFO:root:Epoch 12    loss=0.3035 [28.2 s]    dev=(HR@5:0.9040,NDCG@5:0.7669) [1.0 s] *
INFO:root:Epoch 13    loss=0.2995 [28.0 s]    dev=(HR@5:0.9065,NDCG@5:0.7682) [1.0 s] *
INFO:root:Epoch 14    loss=0.2957 [28.3 s]    dev=(HR@5:0.9080,NDCG@5:0.7694) [1.1 s] *
INFO:root:Epoch 15    loss=0.2922 [28.1 s]    dev=(HR@5:0.9082,NDCG@5:0.7703) [1.1 s] *
INFO:root:Epoch 16    loss=0.2892 [28.4 s]    dev=(HR@5:0.9090,NDCG@5:0.7713) [1.0 s] *
INFO:root:Epoch 17    loss=0.2863 [28.0 s]    dev=(HR@5:0.9104,NDCG@5:0.7724) [1.0 s] *
INFO:root:Epoch 18    loss=0.2835 [28.1 s]    dev=(HR@5:0.9111,NDCG@5:0.7733) [1.0 s] *
INFO:root:Epoch 19    loss=0.2808 [28.0 s]    dev=(HR@5:0.9120,NDCG@5:0.7752) [1.0 s] *
INFO:root:Epoch 20    loss=0.2783 [28.2 s]    dev=(HR@5:0.9131,NDCG@5:0.7757) [1.0 s] *
INFO:root:Epoch 21    loss=0.2756 [28.0 s]    dev=(HR@5:0.9142,NDCG@5:0.7762) [1.1 s] *
INFO:root:Epoch 22    loss=0.2734 [28.2 s]    dev=(HR@5:0.9141,NDCG@5:0.7758) [1.0 s]
INFO:root:Epoch 23    loss=0.2709 [28.5 s]    dev=(HR@5:0.9142,NDCG@5:0.7760) [1.0 s]
INFO:root:Epoch 24    loss=0.2689 [28.0 s]    dev=(HR@5:0.9148,NDCG@5:0.7750) [1.1 s]
INFO:root:Epoch 25    loss=0.2668 [28.3 s]    dev=(HR@5:0.9159,NDCG@5:0.7750) [1.0 s]
INFO:root:Epoch 26    loss=0.2651 [28.7 s]    dev=(HR@5:0.9164,NDCG@5:0.7747) [1.0 s]
INFO:root:Epoch 27    loss=0.2633 [28.3 s]    dev=(HR@5:0.9150,NDCG@5:0.7718) [1.0 s]
INFO:root:Epoch 28    loss=0.2618 [28.3 s]    dev=(HR@5:0.9141,NDCG@5:0.7705) [1.1 s]
INFO:root:Epoch 29    loss=0.2605 [28.3 s]    dev=(HR@5:0.9136,NDCG@5:0.7699) [1.1 s]
INFO:root:Epoch 30    loss=0.2590 [28.0 s]    dev=(HR@5:0.9128,NDCG@5:0.7685) [1.1 s]
INFO:root:Epoch 31    loss=0.2577 [28.3 s]    dev=(HR@5:0.9122,NDCG@5:0.7679) [1.0 s]
INFO:root:Epoch 32    loss=0.2563 [28.2 s]    dev=(HR@5:0.9119,NDCG@5:0.7674) [1.1 s]
INFO:root:Epoch 33    loss=0.2552 [28.2 s]    dev=(HR@5:0.9122,NDCG@5:0.7673) [1.0 s]
INFO:root:Epoch 34    loss=0.2539 [28.3 s]    dev=(HR@5:0.9115,NDCG@5:0.7671) [1.1 s]
INFO:root:Early stop at 34 based on dev result.
INFO:root:
Best Iter(dev)=   21	 dev=(HR@5:0.9142,NDCG@5:0.7762) [1578.4 s] 
INFO:root:Load model from ../model/NeuMF/NeuMF__coclick_1d__0__lr=0.0005__l2=1e-07__emb_size=128__layers=[64].pt
INFO:root:
Test After Training: (HR@5:0.9161,NDCG@5:0.7829,HR@10:0.9929,NDCG@10:0.8081,HR@20:1.0000,NDCG@20:0.8101,HR@50:1.0000,NDCG@50:0.8101)
INFO:root:
--------------------------------------------- END: 2022-07-25 22:19:57 ---------------------------------------------
